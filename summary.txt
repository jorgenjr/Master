
METHODS

* Ethics statement

* Cell lines

Cell line samples were prepared as follows: human cell lines Jurkat (T cell leukemia), THP-1 (acute monocytic leukemia), IM-9 (B lymphoblastoid multiple myeloma) and Raji (Burkitt B-cell lymphoma) were obtained from the American Type Culture Collection (ATCC).

* Purification of Leukocyte Populations

* Clinical samples

 T cell subsets for the proof of concept experiment were prepared as follows: peripheral blood mononuclear cells (PBMCs) were isolated from healthy donors via leukopacks. A portion of each PBMC sample was assayed on gene expression microarrays, while the remainder was used for further purification. Pure CD4+ T cells, CD19+ B cells CD56+ NK cells, and CD14+ monocytes used for confirmation of the deconvolution method were isolated from whole blood obtained from healthy donors by Ficoll gradient centrifugation followed by negative selection. Purity was confirmed by FACS with positive markers.

 * Patient selection

Whole white blood cell samples for exploratory analysis were collected from 72 SLE patients and 45 healthy donors (the test cohort) by Gene Logic Corporation (Gaithersburg, MD). Three additional patients with active SLE were recruited from the outpatient rheumatology clinic and in-patient services at the University of Michigan. These patients, referred to as the validation cohort, were used for FACS confirmation of results obtained from the test cohort. Written informed consent was obtained from all patients. Patients were selected as being over 21 years of age and meeting the diagnostic criteria of the American College of Rheumatology (ACR) for SLE at the time of the visit. Clinical data were collected for each visit and include disease activity as assessed by the SLEDAI activity index, clinical laboratory test results, and current medications.

* Microarray sample processing

Total white blood cell RNA was obtained using the RNeasy Midi kit and the "RNeasy Midi Protocol for Isolation of Total Cellular RNA from Whole Blood" protocol (Qiagen).Purified leukocyte RNA was obtained using the RNeasy Mini Kit (Qiagen). Manufacturers protocol was followed for all steps and the optional on-column DNase treatment was performed. RNA was quantified using ultraviolet spectrophotometry. RNA was labeled for and hybridized to Affymetrix HGU133 expression microarrays assay using standard Affymetrix Microarray Analysis Suite software version 5 to yield Signal data.

* Computational and statistical methods

All statistical and matrix algebra calculations were performed using the R Project software package.

Hierachical clustering was performed on log2-transformed data by hierachically clustering using Pearson correlation coefficient as the similarity metric and average-linkage for node summarization.

Correlation tests between cell types and SLEDAI scores were Spearman correlations, with p-values obtained using the "cor.test" function. Differential cellular abundance by treatment status was tested by Wilcoxon Rank Sum test on linear data.

Expression deconvolution was performed on linear, untransformed data as follows: in each mixture sample, the total expression signal of each microarray probe was modeled as the sum of the expression signals of its constituent parts, each of which is described as a product of the expression signal of that probe in that purified cell type times the fractional abundance of that cell type in the mixture: 
A_{11}*X_{1} + A_{12}*X_{2} ... A_{1j}*X_{j} = B_{1}
A_{21}*X_{1} + A_{22}*X_{2} ... A_{2j}*X_{j} = B_{2}
...
A_{i1}*X_{1} + A_{i2}*X_{2} ... A_{ij}*X_{j} = B_{i}
where A_{ij} is an expression signal measurement in a purified cell, B_{i} is an expression signal measurement in a mixture of cells, and X_{j} is a fractional abundance, for each of i probesets and j cell types. These equations may be rewritten as a matrix equation: AX = B where A is the basis matrix of the expression levels of all probesets in all cell types, B is the vector of expression levels of all probesets in one mixture, and X is the vector of the relative levels of cell types comprising B. The equation was solved for X with the R function 'Isfit' (a linear least squares algorithm) followed by removal of the lowest negative coefficient from the equation and iteration of the solution if necessary until all coefficients were non-negative. Fractions of the cell types were determined by dividing the coefficients by the yield of mRNA per cell input.

The probesets comprising the basis for deconvolution were the subset of all probesets that maximized conditioning of the basis matrix. They were determined as follows: top differentially-expressed (based on 95% fold change confidence intervals from Student's T-test) probesets were determined by comparing each probe's highest-expressed group with the next highest-expressed group in order to find probesets that are good markers for each cell population. This step was repeated with comparison between the top group and the third-highest group in order to also invlude probesets that were strong markers for two cell populations. Basis matrices of increasing numbers of top probesets picked separately from both comparisons and from each group were created and their condition number calculated. The function of condition number based on the number of probesets used to calculate it was observed to be continuous and relatively high for very small or very large numbers of probesets with a minimum for intermediate numbers of probesets. The matrix with the lowest condition number (i.e. the best-conditioned) was selected as the basis matrix to be used for deconvolution.